#import "./fragments/basicComment.graphql"
#import "./fragments/basicCollection.graphql"
#import "./fragments/basicResource.graphql"
#import "./fragments/basicCommunity.graphql"
#import "./fragments/basicUser.graphql"

query getCommunityQuery($communityId: String!, $limit: Int, $end: String) {
    community(communityId: $communityId) {
        id
        canonicalUrl
        preferredUsername
        name
        summary
        icon
        image
        createdAt
        updatedAt
        lastActivity
        isLocal
        isPublic
        isDisabled
        myFollow { id }
        outbox(limit: $limit, after: $end) {
            pageInfo { startCursor endCursor }
            edges {
                node {
                    id
                    canonicalUrl
                    verb
                    isLocal
                    isPublic
                    createdAt
                    published
                    user { ...BasicUser }
                    noun {
                        __typename
                        ... on Community  { ...BasicCommunity  }
                        ... on Comment    { ...BasicComment    }
                        ... on Collection { ...BasicCollection }
                        ... on Resource   { ...BasicResource   }
                    }       
                }
            }
        }
        members {
            pageInfo { startCursor endCursor }
            totalCount
            edges {
                node {
                    id
                    canonicalUrl
                    name
                    icon
                    isLocal
                    isPublic
                    isDisabled
                    myFollow { id }
                }
            }
        }
        collections {
            pageInfo { startCursor endCursor }
            totalCount
            edges {
                node {
                    id
                    canonicalUrl
                    preferredUsername
                    name
                    summary
                    icon
                    followed
                    followers { totalCount }
                    resources { totalCount }
                    threads   { totalCount }
                    outbox    { totalCount }
                }
            }
        }
    }
}
